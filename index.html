<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Terra Crystal Clicker</title>
    <style>
        :root { --neon: #00f2ff; --gold: #f1c40f; }
        body { background: #050505; color: white; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Linke Seite: Die Erde */
        #world-section { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: radial-gradient(circle at center, #001a33 0%, #000 100%); border-right: 2px solid #222; }
        #earth { width: 250px; height: 250px; border-radius: 50%; background: url('https://img.freepik.com') center/cover; background-color: #2980b9; box-shadow: 0 0 50px #2980b9, inset 0 0 50px rgba(0,0,0,0.8); cursor: pointer; transition: transform 0.1s; position: relative; border: 4px solid #1a1a1a; }
        #earth:active { transform: scale(0.95); }
        .world-stat { font-size: 24px; font-weight: bold; margin-bottom: 10px; color: var(--gold); }

        /* Mitte: Merge-Feld */
        #merge-section { flex: 1.5; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        #grid { display: grid; grid-template-columns: repeat(4, 80px); grid-template-rows: repeat(4, 80px); gap: 10px; background: #111; padding: 15px; border-radius: 15px; border: 2px solid #333; }
        .slot { width: 80px; height: 80px; background: #0a0a0a; border-radius: 10px; border: 1px solid #222; display: flex; align-items: center; justify-content: center; cursor: pointer; position: relative; }
        .crystal { width: 60%; height: 60%; transform: rotate(45deg); box-shadow: 0 0 15px currentColor; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; color: white; }
        .crystal span { transform: rotate(-45deg); }

        /* Rechts: Upgrades */
        #upgrade-section { flex: 1.2; background: #0f0f0f; border-left: 2px solid #222; padding: 20px; overflow-y: auto; }
        .upgrade-card { background: #1a1a1a; border: 1px solid #333; padding: 10px; margin-bottom: 10px; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .upgrade-card:hover { border-color: var(--neon); background: #222; }
        .upgrade-card.locked { opacity: 0.4; cursor: not-allowed; }
        .upgrade-card h4 { margin: 0; color: var(--neon); }
        .upgrade-card p { margin: 5px 0; font-size: 12px; color: #aaa; }
        .price { color: var(--gold); font-weight: bold; }

        .floating-text { position: absolute; pointer-events: none; animation: floatUp 1s forwards; font-weight: bold; }
        @keyframes floatUp { to { transform: translateY(-100px); opacity: 0; } }
    </style>
</head>
<body>

    <div id="world-section">
        <div class="world-stat" id="money-display">0 ðŸª™</div>
        <div id="gps-display" style="color: #00f2ff; margin-bottom: 20px;">GPS: 0</div>
        <div id="earth" onclick="clickEarth(event)"></div>
        <h2 id="world-name">Ã–de Erde</h2>
        <p id="click-val" style="color: #666;">Pro Klick: +1</p>
    </div>

    <div id="merge-section">
        <h3>Kristall-Hangar</h3>
        <div id="grid"></div>
        <button onclick="buyCrystal()" id="buy-btn" style="margin-top: 20px; padding: 15px 30px; background: var(--neon); border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">Kristall kaufen (<span id="buy-price">10</span> ðŸª™)</button>
    </div>

    <div id="upgrade-section">
        <h3>Welt-Upgrades</h3>
        <div id="upgrade-list"></div>
    </div>

<script>
    let money = 0;
    let gps = 0;
    let clickPower = 1;
    let crystalBasePrice = 10;
    let crystalCount = 0;
    let grid = Array(16).fill(null);
    let selectedIdx = null;

    // Upgrades System (30+ geplant, hier die Logik)
    const upgrades = [
        { id: 'forest', name: 'WÃ¤lder pflanzen', desc: 'ErhÃ¶ht Klick-Power um +2', cost: 50, growth: 1.5, type: 'click', power: 2 },
        { id: 'ocean', name: 'Ozeane fÃ¼llen', desc: 'Alle Kristalle produzieren +10% mehr', cost: 200, growth: 1.6, type: 'mult', power: 1.1 },
        { id: 'atmo', name: 'AtmosphÃ¤re', desc: 'Halbiert die Preissteigerung von Kristallen', cost: 1000, growth: 2.5, type: 'discount', power: 0.9 },
        { id: 'tectonic', name: 'Plattentektonik', desc: 'GPS +50', cost: 5000, growth: 1.4, type: 'gps', power: 50 },
        { id: 'life', name: 'Erstes Leben', desc: 'Verdreifacht Klick-Power', cost: 15000, growth: 3, type: 'click_mult', power: 3 },
        { id: 'core', name: 'Erdkern-Erhitzung', desc: 'Kristalle spawnen auf Level 2', cost: 50000, growth: 5, type: 'spawn_lvl', power: 1 }
    ];
    let activeUpgrades = {};

    // Kristall-Generator (Generiert Farben fÃ¼r 50+ Stufen)
    function getCrystalStyle(lvl) {
        const hue = (lvl * 45) % 360;
        return `background: hsl(${hue}, 70%, 50%); color: hsl(${hue}, 70%, 20%); box-shadow: 0 0 15px hsl(${hue}, 70%, 50%);`;
    }

    function getCrystalGPS(lvl) {
        return Math.pow(4, lvl - 1);
    }

    function initGrid() {
        const gridEl = document.getElementById('grid');
        gridEl.innerHTML = '';
        grid.forEach((val, i) => {
            const slot = document.createElement('div');
            slot.className = 'slot';
            if (i === selectedIdx) slot.style.borderColor = 'white';
            
            if (val) {
                const cry = document.createElement('div');
                cry.className = 'crystal';
                cry.setAttribute('style', getCrystalStyle(val));
                cry.innerHTML = `<span>Lvl ${val}</span>`;
                slot.appendChild(cry);
            }
            slot.onclick = () => handleSlotClick(i);
            gridEl.appendChild(slot);
        });
    }

    function handleSlotClick(i) {
        if (selectedIdx === null) {
            if (grid[i]) selectedIdx = i;
        } else {
            if (selectedIdx !== i && grid[selectedIdx] === grid[i] && grid[i] < 50) {
                grid[i]++;
                grid[selectedIdx] = null;
            } else if (selectedIdx !== i) {
                [grid[i], grid[selectedIdx]] = [grid[selectedIdx], grid[i]];
            }
            selectedIdx = null;
        }
        initGrid();
    }

    function buyCrystal() {
        let price = Math.floor(crystalBasePrice * Math.pow(1.15, crystalCount));
        let empty = grid.indexOf(null);
        if (money >= price && empty !== -1) {
            money -= price;
            grid[empty] = activeUpgrades['core'] ? 2 : 1;
            crystalCount++;
            initGrid();
            updateUI();
        }
    }

    function clickEarth(e) {
        money += clickPower;
        const text = document.createElement('div');
        text.className = 'floating-text';
        text.style.left = e.clientX + 'px';
        text.style.top = e.clientY + 'px';
        text.style.color = 'white';
        text.innerText = `+${clickPower}`;
        document.body.appendChild(text);
        setTimeout(() => text.remove(), 1000);
        updateUI();
    }

    function updateUI() {
        document.getElementById('money-display').innerText = Math.floor(money).toLocaleString() + " ðŸª™";
        document.getElementById('gps-display').innerText = "Produktion: " + gps.toLocaleString() + " /s";
        let nextPrice = Math.floor(crystalBasePrice * Math.pow(1.15, crystalCount));
        document.getElementById('buy-price').innerText = nextPrice.toLocaleString();
        document.getElementById('click-val').innerText = `Pro Klick: +${clickPower}`;
        
        // Upgrades rendern
        const list = document.getElementById('upgrade-list');
        list.innerHTML = '';
        upgrades.forEach(up => {
            const count = activeUpgrades[up.id] || 0;
            const currentCost = Math.floor(up.cost * Math.pow(up.growth, count));
            const card = document.createElement('div');
            card.className = `upgrade-card ${money < currentCost ? 'locked' : ''}`;
            card.innerHTML = `
                <h4>${up.name} (Lv. ${count})</h4>
                <p>${up.desc}</p>
                <div class="price">Preis: ${currentCost.toLocaleString()} ðŸª™</div>
            `;
            card.onclick = () => buyUpgrade(up, currentCost);
            list.appendChild(card);
        });
    }

    function buyUpgrade(up, cost) {
        if (money >= cost) {
            money -= cost;
            activeUpgrades[up.id] = (activeUpgrades[up.id] || 0) + 1;
            
            // Logik der Upgrades
            if (up.type === 'click') clickPower += up.power;
            if (up.type === 'gps') gps += up.power;
            if (up.type === 'click_mult') clickPower *= up.power;
            if (up.type === 'discount') crystalBasePrice *= up.power;
            
            updateUI();
        }
    }

    // Game Loop
    setInterval(() => {
        let currentGps = 0;
        grid.forEach(val => {
            if (val) currentGps += getCrystalGPS(val);
        });
        
        // Multiplikator Upgrades anwenden
        if (activeUpgrades['ocean']) currentGps *= (1 + (activeUpgrades['ocean'] * 0.1));
        
        gps = Math.floor(currentGps);
        money += gps / 10;
        updateUI();
    }, 100);

    initGrid();
</script>
</body>
</html>
